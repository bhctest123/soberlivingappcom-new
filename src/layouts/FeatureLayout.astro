---
import BaseLayout from './BaseLayout.astro';
import FeatureTourNav from '@/components/features/FeatureTourNav.astro';
import '../styles/features.css';

export interface Props {
  feature: {
    id: string;
    name: string;
    description: string;
    iconPath: string;
    altText: string;
  };
  seo: {
    title: string;
    description: string;
    canonical?: string;
    ogType?: string;
    noindex?: boolean;
    image?: string;
    twitterCard?: string;
    keywords?: string[];
  };
  content?: {
    heroTitle?: string;
    heroDescription?: string;
    keyBenefits?: string[];
    features?: Array<{
      title: string;
      description: string;
      icon?: string;
    }>;
    additionalSections?: Array<{
      title: string;
      content: string;
    }>;
  };
}

const { feature, seo, content } = Astro.props;

// Ensure we have default values
const heroTitle = content?.heroTitle || feature.name;
const heroDescription = content?.heroDescription || feature.description;
const pageTitle = seo.title || `${feature.name} - Sober Living App`;
const pageDescription = seo.description || feature.description;
---

<BaseLayout
  title={pageTitle}
  description={pageDescription}
  canonical={seo.canonical}
  ogType={seo.ogType || "website"}
  noindex={seo.noindex || false}
  image={seo.image}
>
  <!-- Hero Section -->
  <section class="feature-hero">
    <!-- Background decoration -->
    <div class="feature-hero-blobs">
      <div class="feature-hero-blob absolute top-0 -left-4 w-96 h-96 bg-purple-400"></div>
      <div class="feature-hero-blob absolute top-0 -right-4 w-96 h-96 bg-yellow-400 animation-delay-2000"></div>
      <div class="feature-hero-blob absolute -bottom-8 left-20 w-96 h-96 bg-pink-400 animation-delay-4000"></div>
      <div class="feature-hero-blob absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-blue-300 animation-delay-1000"></div>
    </div>
    
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
      <div class="text-center">
        <!-- Feature Icon -->
        <div class="flex justify-center mb-10">
          <div class="feature-hero-icon-wrapper">
            <div class="feature-hero-icon-glow-primary"></div>
            <div class="feature-hero-icon-glow-secondary"></div>
            <div class="feature-hero-icon-container">
              <img 
                src={feature.iconPath} 
                alt={feature.altText}
                class="feature-hero-icon"
                loading="eager"
              />
            </div>
          </div>
        </div>
        
        <!-- Hero Title -->
        <h1 class="feature-hero-title">
          <span class="feature-hero-title-gradient">
            {heroTitle}
          </span>
        </h1>
        
        <!-- Hero Description -->
        <p class="text-xl lg:text-2xl text-gray-700 max-w-4xl mx-auto mb-10 leading-relaxed">
          {heroDescription}
        </p>
        
        <!-- CTA Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a 
            href="https://behavehealth.com/get-started" 
            class="btn-primary"
          >
            Get Started
            <img src="/images/icons/long_arrow_right.png" alt="Arrow" class="btn-arrow-white" />
          </a>
          <a 
            href="/contact" 
            class="btn-secondary"
          >
            Learn More
            <img src="/images/icons/chevron_right.png" alt="Arrow" class="btn-arrow-dark" />
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Key Benefits Section -->
  {content?.keyBenefits && content.keyBenefits.length > 0 && (
    <section class="py-20 bg-gradient-to-b from-white to-gray-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
          <h2 class="feature-section-title">
            Key Benefits
          </h2>
          <p class="feature-section-subtitle">
            Discover how <span class="font-semibold text-blue-600">{feature.name}</span> can transform your sober living operations
          </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {content.keyBenefits.map((benefit, index) => (
            <div class="benefit-card">
              <div class="benefit-card-accent"></div>
              <div class="flex flex-col items-center text-center">
                <div class="benefit-icon-box">
                  <span class="text-blue-600 font-bold text-xl">{index + 1}</span>
                </div>
                <p class="text-gray-700 leading-relaxed text-lg">{benefit}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Features Detail Section -->
  {content?.features && content.features.length > 0 && (
    <section class="py-20 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
          <h2 class="feature-section-title">
            Features & Capabilities
          </h2>
          <p class="feature-section-subtitle">
            Explore the comprehensive features that make <span class="font-semibold text-blue-600">{feature.name}</span> essential for your operations
          </p>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          {content.features.map((feat) => (
            <div class="feature-card">
              <div class="feature-card-decoration"></div>
              <div class="relative flex items-start space-x-5">
                {feat.icon && (
                  <div class="feature-icon-box">
                    <img src={feat.icon} alt="" class="feature-icon" />
                  </div>
                )}
                <div class="flex-1">
                  <h3 class="feature-card-title">{feat.title}</h3>
                  <p class="feature-card-description">{feat.description}</p>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Additional Content Sections -->
  {content?.additionalSections && content.additionalSections.length > 0 && (
    content.additionalSections.map((section, index) => (
      <section class={`py-20 ${index % 2 === 0 ? 'bg-gradient-to-b from-gray-50 to-white' : 'bg-gradient-to-b from-white to-gray-50'}`}>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="max-w-5xl mx-auto">
            <h2 class="feature-section-title mb-12 text-center">
              <span class="feature-hero-title-gradient">
                {section.title}
              </span>
            </h2>
            <div class="prose prose-lg prose-blue mx-auto text-gray-600 max-w-none" set:html={section.content} />
          </div>
        </div>
      </section>
    ))
  )}

  <!-- Slot for additional custom content -->
  <slot />

  <!-- Feature Tour Navigation -->
  <FeatureTourNav currentFeatureId={feature.id} />

  <!-- Call to Action Section -->
  <section class="relative py-24 overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600"></div>
    <div class="absolute inset-0 bg-black opacity-10"></div>
    
    <!-- Background pattern -->
    <div class="absolute inset-0 opacity-10">
      <div class="absolute -top-10 -right-10 w-96 h-96 bg-white rounded-full mix-blend-soft-light animate-pulse"></div>
      <div class="absolute -bottom-10 -left-10 w-96 h-96 bg-white rounded-full mix-blend-soft-light animate-pulse animation-delay-2000"></div>
    </div>
    
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-4xl lg:text-5xl font-bold text-white mb-6">
        Ready to streamline your <span class="text-yellow-300">{feature.name.toLowerCase()}</span>?
      </h2>
      <p class="text-xl lg:text-2xl text-blue-100 max-w-3xl mx-auto mb-12">
        Join hundreds of sober living operators who trust Sober Living App to manage their operations efficiently.
      </p>
      <div class="flex flex-col sm:flex-row gap-6 justify-center">
        <a 
          href="https://behavehealth.com/get-started" 
          class="group inline-flex items-center px-10 py-5 text-lg font-semibold rounded-xl text-blue-600 bg-white hover:bg-gray-50 transition-all duration-200 shadow-xl hover:shadow-2xl transform hover:-translate-y-1"
        >
          Start Free Trial
          <img src="/images/icons/long_arrow_right.png" alt="Arrow" class="ml-3 w-6 h-6 group-hover:translate-x-1 transition-transform" />
        </a>
        <a 
          href="/contact" 
          class="group inline-flex items-center px-10 py-5 text-lg font-semibold rounded-xl text-white border-2 border-white hover:bg-white hover:text-blue-600 transition-all duration-200 shadow-xl hover:shadow-2xl transform hover:-translate-y-1"
        >
          Schedule Demo
          <img src="/images/icons/ic_schedule.png" alt="Calendar" class="ml-3 w-6 h-6 group-hover:translate-x-1 transition-transform" />
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .prose img {
    @apply rounded-lg shadow-md;
  }
  
  .prose h2 {
    @apply text-gray-900 font-bold text-3xl mb-6;
  }
  
  .prose h3 {
    @apply text-gray-900 font-semibold text-2xl mb-4;
  }
  
  .prose p {
    @apply text-gray-600 leading-relaxed text-lg mb-6;
  }
  
  .prose ul {
    @apply space-y-3 mb-6;
  }
  
  .prose ul li {
    @apply text-gray-600 text-lg;
  }
  
  .prose ul li::marker {
    @apply text-blue-600;
  }
  
  .prose strong {
    @apply text-gray-900 font-semibold;
  }
</style>